<HTML><HEAD>
<TITLE>April 2000/Stressing Your COM Objects/Figure 1</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 1: Partial listing of the example CmyString class</A></h4>
<pre>
class ATL_NO_VTABLE CmyString : 
    public CComObjectRootEx&lt;CComMultiThreadModel&gt;,
    public CComCoClass&lt;CmyString, &amp;CLSID_myString&gt;,
    public IDispatchImpl&lt;ImyString, &amp;IID_ImyString, 
        &amp;LIBID_MYSTRINGOBJECTLib&gt;
{
// ...
private:
    long m_counter;

public:
    STDMETHOD(capitalize)(/*[in,out]*/BSTR* str);
    STDMETHOD(get_counter)(/*[out, retval]*/ long *pVal);
};
</pre></body></html>
