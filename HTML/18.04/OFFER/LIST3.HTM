<HTML><HEAD>
<TITLE>April 2000/Error Logging with Iostreams/Listing 3</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 3: Driver program for testing Errstream class</A></h4>
<pre>
#include "Errstream.h"

void displayErrMsg(const char *msg)
{
    cerr &lt;&lt; "ERROR: " &lt;&lt; msg &lt;&lt; endl;
}

void main()
{
    errout.setDisplay(displayErrMsg);

    int i, d = 100;
    char *cStr = "string";
    double f = 123.456;

    errout &lt;&lt; "character string: " &lt;&lt; cStr &lt;&lt; dspl;
    errout &lt;&lt; "integer:          " &lt;&lt; d    &lt;&lt; dspl;
    errout &lt;&lt; "floating point:   " &lt;&lt; f    &lt;&lt; dspl;

    errout.open("newErrorLog");

    errout &lt;&lt; logOnly
           &lt;&lt; "The user doesn't need to see this message"
           &lt;&lt; dspl;

    for(i = 0; i &lt; 5; i++)
        errout &lt;&lt; "This message only gets logged once" &lt;&lt; dspl;
    errout.collect(false);
    for(i = 0; i &lt; 5; i++)
        errout &lt;&lt; "This message gets logged every time" &lt;&lt; dspl;
    errout.collect(true);

    for(i = 0; i &lt; 5; i++)
    {
        errout &lt;&lt; "Encountered error #";
        switch(i)
        {
            case 0:
                errout &lt;&lt; differentiate(1) &lt;&lt; i;  break;
            case 1:
                errout &lt;&lt; differentiate(2) &lt;&lt; i;  break;
            default:
                errout &lt;&lt; differentiate(3) &lt;&lt; i;  break;
        }
        errout &lt;&lt; " inside a loop" &lt;&lt; dspl;
    }
}
</pre></body></html>
