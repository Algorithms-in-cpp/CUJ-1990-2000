



<HTML><HEAD>

<TITLE>June 1997/A Windows Shell for Legacy MS-DOS Applications/Listing 1</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">
<h4>Listing 1:	PipedProcess.h : header file</h4>

<pre>
////////////////////////////////////////////
// CPipedProcess window

#define BUFSIZE  1024 

class CPipedProcess 
{
public:
  

  CPipedProcess() {};
  ~CPipedProcess() {};

public:
  HANDLE hChildStdinRd, hChildStdinWr, hChildStdinWrDup, hChildStdoutRd, hChildStdoutWr; 

public:
  BOOL   CreateProc(char* ExeFileName);
  BOOL   CreateChildProcess(char *ChildName); 
  DWORD  WriteToPipe(char *command); 
  DWORD  ReadFromPipe(CString&amp; chBuf); 
  void   ErrorExit(char *ErrorMsg); 
  DWORD  ProcessCommand(CString Command, CString&amp; ResultBuf);
  void   CloseChildProcess(void);
}
//End of File
</pre>
</body></html>
