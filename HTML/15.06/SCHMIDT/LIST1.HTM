



<HTML><HEAD>

<TITLE>June 1997/The Learning C/C++urve/Listing 1</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">
<h4>Listing 1:	Revamped our_string.c</h4>

<pre>
#include "our_string.h"

#include &lt;string.h&gt;

void construct(string * const this, const char *data)
    {
    if (data == NULL)
        {
        this-&gt;length_ = 0;
        this-&gt;data_ = NULL;
        }
    else
        {
        this-&gt;length_ = strlen(data);
        this-&gt;data_ = (char *) malloc(this-&gt;length_ + 1);
        strcpy(this-&gt;data_, data);
        }
    }

static void destruct(string * const this)
    {
    if (this-&gt;data_ != NULL)
        free(this-&gt;data_);
    }

static size_t length(const string * const this)
    {
    return this-&gt;length_;
    }

const struct string_interface_ STRING =
    {
    construct,
    destruct,
    length
    };
/* End of File */
</pre>
</body></html>
