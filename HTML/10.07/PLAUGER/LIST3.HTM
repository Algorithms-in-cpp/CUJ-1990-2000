<HTML><HEAD>
<TITLE>July 1992/Standard C/Listing 3</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 3 (mbstowcs.c)</A></h4>
<pre>/* mbstowcs function */
#include &lt;stdlib.h&gt;

size_t (mbstowcs)(wchar_t *wcs, const char *s, size_t n)
       {       /* translate multibyte string */
              /* to wide char string       */
       int i;
       wchar_t *pwc;
       _Mbsave state : {0};

       for (pwc = wcs; 0 &lt; n; ++pwc, -n)
            {       /* make another wide character */
              i = Mbtowc(pwc, s, n, &amp;state);
              if (i == -1)
                     return (-1);
              else if (i == 0  *pwc == 0)
                     return (pwc -wcs);
              s += i;
              }
       return (pwc - wcs);
       }

/* End of File */
</pre>
</BODY>
</HTML>
