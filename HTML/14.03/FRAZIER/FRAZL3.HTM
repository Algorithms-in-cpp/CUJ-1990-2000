



<HTML><HEAD>

<TITLE>March 1996/Estimating Time-To-Transfer/Listing 3</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">
<p><tt>Listing 3:	Member function CalculateTransferRate</tt><br>
<tt>float TCountDownClock::CalculateTransferRate(float fOverallAvg)</tt><br>
<tt>{</tt><br>
<tt>  long lAvgWeight;</tt><br>
<tt>  float fWeightedRecentAvg;</tt><br>
<tt>  // the weighting for the recent average</tt><br>
<tt>  // is always 3.  Calculate the weight for</tt><br>
<tt>  // the overall average</tt><br>
<tt>  lAvgWeight = m_lIntervalCount / kHistoryEntries;</tt><br>
<tt>  </tt><br>
<tt>  // compute the weighted average of recent </tt><br>
<tt>  // transfer rates</tt><br>
<tt>  fWeightedRecentAvg = WeighRecentRates();</tt><br>
<tt>  </tt><br>
<tt>  // return the overall weighted average</tt><br>
<tt>  // transfer rate in bytes/second</tt><br>
<tt>  </tt><br>
<tt>  return (</tt><br>
<tt>         (fWeightedRecentAvg * 3 + </tt><br>
<tt>         fOverallAvg * lAvgWeight) /</tt><br>
<tt>         (float)(3 + lAvgWeight)</tt><br>
<tt>         );</tt><br>
<tt>}</tt><br>
<tt>// ----------------------------------------------
</tt></p>
</body></html>
