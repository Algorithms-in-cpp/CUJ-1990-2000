



<HTML><HEAD>

<TITLE>March 1996/Estimating Time-To-Transfer/Listing 3</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4>
<A name="HEADING1">Listing 3: Member function CalculateTransferRate</A></h4>


<pre>

float TCountDownClock::CalculateTransferRate(float fOverallAvg)
{
  long lAvgWeight;
  float fWeightedRecentAvg;
  // the weighting for the recent average
  // is always 3.  Calculate the weight for
  // the overall average
  lAvgWeight = m_lIntervalCount / kHistoryEntries;
  
  // compute the weighted average of recent 
  // transfer rates
  fWeightedRecentAvg = WeighRecentRates();
  
  // return the overall weighted average
  // transfer rate in bytes/second
  
  return (
         (fWeightedRecentAvg * 3 + 
         fOverallAvg * lAvgWeight) /
         (float)(3 + lAvgWeight)
         );
}
// ----------------------------------------------
</pre>
</body></html>
