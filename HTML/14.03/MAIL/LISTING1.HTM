



<HTML><HEAD>

<TITLE>March 1996/We Have Mail/Listing 1</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4>
<A name="HEADING1">Listing 1: Microsoft's _memmax program</A></h4>


<pre>

/* MEMMAX.C: This program uses 
 * _memmax and _nmalloc to allocate
 * the largest block of memory 
 * available in the near heap.
 */
#include &lt;stddef.h&gt;
#include &lt;malloc.h&gt;
#include &lt;stdio.h&gt;
void main( void )
{
   size_t contig;
   char *p;
   /* Determine contiguous 
      memory size */
   contig = _memmax();
   printf("Largest block of 
          available memory is %u 
          bytes long\n", 
          contig  );
   if( contig )
   {
      p = _nmalloc(
               contig*sizeof(int));
      if( p == NULL )
         printf("Error with malloc 
                (should never 
                 occur)\n" );
      else
      {
         printf("Maximum allocation 
                succeeded\n" );
         free( p );
      }
   }
   else
      printf( "Near heap is already 
               full\n" );
}
/* end of MEMMAX.C */
</pre>
</body></html>
