<HTML><HEAD>
<TITLE>May 1991/Digital Signal Processing: A Tutorial/Listing 4</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 4</A></h4>
<pre>#include &lt;math.h&gt;

/* apply a filter */

double filter( double s[], double y[],double A[]
    double a[],int n, int N)
   {
   double sum=0.; int k;
   for(k=0;k&lt;n;k++) sum += a[k]*s[n-k];
   for(k=1;k&lt;N;k++) sum += A[k]*y[N-k];
   return (y[n] =sum);
   }

/* Set coefficients for two typical low-pass
   windowing filters */

/* window size 2n-1 */

hamming(double a[],int n)
   {
   int k,m=(n&lt;&lt;1)-1;double c;
   c=3.14159265358979323/n;
   for(k=0;k&lt;m;k++) a[k]=.54+.46*cos( c*k );
   }

/* the Hanning window is another possible
   winder choice*/

hanning(double a[],int n)
   {
   int k,m=(n&lt;&lt;1)-1;double c;
   c=3.14159265358979323/n;
   for(k:0;k&lt;m;k++) a[k]=.5+.5*cos( c*k );
   }</pre>

</BODY>
</HTML>
