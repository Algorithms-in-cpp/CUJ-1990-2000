



<HTML><HEAD>

<TITLE>May 1996/Object Persistence with Relational Databases/Listing 2</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">
<H4><A name="HEADING1">Listing 2:	Implements EmpRecSet class</A></H4>

<PRE>
//  EmpRecset.cpp:
//  implementation  generated  by  Class  Wizard
//

#include  "EmpRecSet.h"

#ifdef  _DEBUG
#define  new  DEBUG_NEW
#undef  THIS_FILE
static  char  THIS_FILE[]  =  __FILE__;
#endif

////////////////////////////////////////////
//  EmpRecset

IMPLEMENT_DYNAMIC(EmpRecSet,  CRecordset)

EmpRecSet::EmpRecSet(CDatabase*  pdb)
         : CRecordset(pdb)
{
    //{{AFX_FIELD_INIT(EmpRecSet)
    m_Employee_ID  =  0;
    m_Last_Name  =  _T("");
    m_First_Name  =  _T("");
    m_Home_Phone  =  _T("");
    m_Reports_To  =  0;
    m_nFields  =  5;
    //}}AFX_FIELD_INIT
    m_nDefaultType  =  snapshot;
}

CString  EmpRecSet::GetDefaultConnect()
{
    return  _T("ODBC;DSN=North  Wind");
}

CString  EmpRecSet::GetDefaultSQL()
{
    return  _T("[Employees]");
}

void
EmpRecSet::DoFieldExchange(CFieldExchange*  pFX)
{
//{{AFX_FIELD_MAP(EmpRecSet)
pFX-&gt;SetFieldType(CFieldExchange::outputColumn);
    RFX_Long(pFX,  _T("[Employee  ID]"),
             m_Employee_ID);
    RFX_Text(pFX,  _T("[Last  Name]"),
             m_Last_Name);
    RFX_Text(pFX,  _T("[First  Name]"),
             m_First_Name);
    RFX_Text(pFX,  _T("[Home  Phone]"),
             m_Home_Phone);
    RFX_Long(pFX,  _T("[Reports  To]"),
             m_Reports_To);
//}}AFX_FIELD_MAP
}

////////////////////////////////////////////////
//  EmpRecSet  diagnostics

#ifdef  _DEBUG
void  EmpRecSet::AssertValid()  const
{
    CRecordset::AssertValid();
}

void  EmpRecSet::Dump(CDumpContext&amp;  dc)  const
{
    CRecordset::Dump(dc);
}
#endif  //_DEBUG

//End of File
</PRE>
</body></html>
