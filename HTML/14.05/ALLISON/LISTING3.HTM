



<HTML><HEAD>

<TITLE>May 1996/Object Persistence with Relational Databases/Listing 3</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4>
<A name="HEADING1">Listing 3: Illustrates use of CDatabase and CRecordset</A></h4>


<pre>

//  Test1.cpp
#include  "EmpRecSet.h"
#include  &lt;iostream.h&gt;
#include  &lt;fstream.h&gt;

main()
{
        //  Connect  to  Database:
        CDatabase  db;
        db.Open(0,FALSE,TRUE,
                        "ODBC;DSN=North  Wind");

        //  Define/populate  recordset:
        EmpRecSet  e(&amp;db);
        e.m_strFilter  =  "[Employee  ID]  &gt;  5";
        e.Open();

        //  Print  data:
        ofstream  outf("Employee1.out",
                                    ios::trunc  |  ios::out);
        while  (!e.IsEOF())
        {
                outf  &lt;&lt;  '{'  &lt;&lt;  e.m_Employee_ID
                          &lt;&lt;  ','  &lt;&lt;  e.m_Last_Name
                          &lt;&lt;  ','  &lt;&lt;  e.m_First_Name
                          &lt;&lt;  ','  &lt;&lt;  e.m_Home_Phone
                          &lt;&lt;  ','  &lt;&lt;  e.m_Reports_To
                          &lt;&lt;  '}'  &lt;&lt;  endl;
                e.MoveNext();
        }
        return  0;
}

/*  Output:
{6,Suyama,Michael,(71)  555-7773,5}
{7,King,Jonathan,(71)  555-5598,5}
{8,Callahan,Linda,(206)  555-1189,2}
{9,Dodsworth,Annabella,(71)  555-4444,5}
*/

//End of File
</pre>
</body></html>
