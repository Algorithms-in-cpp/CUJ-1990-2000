<HTML><HEAD>
<TITLE>April 1999/Using Asynchronous Calls in COM/Figure 4</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 4: Request class for the sample application</A></h4>
<pre>
#ifndef REQUEST_H
#define REQUEST_H

#include "resultIOU.h"
#include "error.h"

struct IRequest;
struct IResultIOUReadable;

class IOUSink;

class Request : public SupportsErrorInfo
{
public:
    Request();
    ~Request();

    bool select(BSTR selectStatement);
    bool send(bool notify, ResultIOU&amp; IOU);

protected:
    virtual void 
    getErrorInfoParams(IUnknown *&amp;pUnk, 
        const IID *&amp;riid) const;

private:
    IOUSink* 
    createAndConnectSink
        (IResultIOUReadable *pResultIOU);

    const Request&amp;
    operator=(const Request&amp;);
    Request(const Request&amp;);

    mutable IRequest *pRequest_;
};


</pre>
</BODY>
</HTML>
