<HTML><HEAD>
<TITLE>April 1999/Using Asynchronous Calls in COM/Figure 6</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 6: ResultIOU class for sample application</A></h4>
<pre>
#ifndef RESULTIOU_H
#define RESULTIOU_H

#include "error.h"

struct IResultIOU;

class IOUSink;

class ResultIOU : public SupportsErrorInfo
{
friend IOUSink;

public:
    ResultIOU(IResultIOUReadable*
        pResultIOU=0);
    ResultIOU(const ResultIOU&amp;);
    virtual ~ResultIOU();

    ResultIOU&amp;
    operator=(const ResultIOU&amp; rhs);
        VARIANT Redeem();

protected:
    virtual void 
    getErrorInfoParams(IUnknown *&amp;pUnk, 
        const IID *&amp;riid) const;
    virtual void ResultIOUComplete() {}

private:
    void
    Close(IResultIOUReadable*
        pResultIOU);

    IResultIOUReadable *pResultIOU_;

    friend class Request;
};

</pre>
</BODY>
</HTML>
