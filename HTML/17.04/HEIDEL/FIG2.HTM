<HTML><HEAD>
<TITLE>April 1999/Using Asynchronous Calls in COM/Figure 2</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 2: Class ResultIOU_ definition</A></h4>
<pre>
#ifndef __RESULTIOU__H_
#define __RESULTIOU__H_

#include "refcountbase.h"
#include "mutex.h"
#include "event.h"

template&lt;class T&gt;
class ResultIOU_ : public RefCountBase
{
public:
    ResultIOU_();
    virtual ~ResultIOU_();
    ResultIOU_(const ResultIOU_&amp; rhs);
    ResultIOU_&amp; 
    operator=(const ResultIOU_&amp; rhs);

    void Abort();
    T Redeem();
    bool Redeemable() const;
    bool Aborted() const;
    void Close(T t);

private:
    T t_;
    Event closedEvent_;
    Mutex mutex_;
    bool resultReady_;
    bool aborted_;
};

</pre>
</BODY>
</HTML>
