<HTML><HEAD>
<TITLE>April 1999/Report Generation Using an Integrated Web Browser/Figure 5</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 5: Static member functions of class CMortCalcDlg</A></h4>
<pre>
// Define static class members

int CMortCalcDlg::month(1);
int CMortCalcDlg::year(1);

// not shown: vTitleLine(ostream &amp;stream, void *data, int page_num)
// ...

void CMortCalcDlg::vPaymentLine(ostream &amp;stream, void *data)
{
    LoanPayment *payment = (LoanPayment *)data;

    stream &lt;&lt; "&lt;TR align=right&gt;" &lt;&lt; endl;

    stream &lt;&lt;"&lt;TD&gt;" &lt;&lt; "Year " &lt;&lt; year &lt;&lt; " Month " &lt;&lt; month 
           &lt;&lt; "&lt;/TD&gt;" &lt;&lt;endl;
    stream &lt;&lt; "&lt;TD&gt;" &lt;&lt; payment-&gt;dPrincipal &lt;&lt; "&lt;/TD&gt;" &lt;&lt; endl;
    stream &lt;&lt; "&lt;TD&gt;" &lt;&lt; payment-&gt;dInterest &lt;&lt; "&lt;/TD&gt;" &lt;&lt; endl;
    stream &lt;&lt; "&lt;TD&gt;" &lt;&lt; payment-&gt;dAmountRemaining &lt;&lt; "&lt;/TD&gt;" 
           &lt;&lt; endl;
    stream &lt;&lt; "&lt;/TR&gt;" &lt;&lt; endl;
    month++;

    // Use static class members to keep track of the current month
    // and year.
    if (month == 12)
    {
        month = 1;
        year++;
    }

}

void CMortCalcDlg::vTotalLine(ostream &amp;stream, void *data)
{
    CMortTotal *total = (CMortTotal *)data;

    stream &lt;&lt; "&lt;TR align=right&gt;" &lt;&lt; endl;
    stream &lt;&lt;"&lt;TH&gt;" &lt;&lt; total-&gt;GetPaymentInfo() &lt;&lt; "&lt;/TH&gt;" &lt;&lt;endl;
    stream &lt;&lt; "&lt;TH&gt;" &lt;&lt; total-&gt;GetTotalPrincipal() &lt;&lt; "&lt;/TH&gt;" 
           &lt;&lt; endl;
    stream &lt;&lt; "&lt;TH&gt;" &lt;&lt; total-&gt;GetTotalInterest() &lt;&lt; "&lt;/TH&gt;" 
           &lt;&lt; endl;
    stream &lt;&lt; "&lt;TH&gt;" &lt;&lt; "" &lt;&lt; "&lt;/TH&gt;" &lt;&lt; endl;
    stream &lt;&lt; "&lt;/TR&gt;" &lt;&lt; endl;
}

void 
CMortCalcDlg::vFooterLine(ostream &amp;stream, 
    void *data, int page_num)
{
    // There is no Footer for this report
}



</pre>
</BODY>
</HTML>
