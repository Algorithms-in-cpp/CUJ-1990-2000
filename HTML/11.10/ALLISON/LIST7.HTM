<HTML><HEAD>
<TITLE>October 1993/Code Capsules/Listing 7</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 7 <I>Implementation of Stopwatch Functions</I></A></h4>
<pre>/* clock.c:                    */
 * IBM PC Clock tick functions */

#include &lt;dos.h&gt;

/* Pointer to the clock tick */
static volatile unsigned long far
        *tptr= MK_FP(0,0x46c);

static unsigned long start = 0L;

/* clock_reset: Resets the timer */
void clock_reset(void)
{
   start = *tptr;
}

/* clock_wait:                     */
 * Waits a certain number of ticks */
void clock_wait(unsigned long n)
{
   start = *tptr;
   while ((*tptr - start) &lt; n)
      ;
}

/* clock_elapsed: Returns the       */
 * number of ticks since last reset */
unsigned long clock_elapsed(void)
{
   return *tptr - start;
}

/* End of File */
</pre>
</BODY>
</HTML>
