<HTML><HEAD>
<TITLE>April 1993/Mixed Numbers in C/Listing 8</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 8 primes.c &#151; <I>function to set up table of prime numbers</I></A></h4>
<pre>/* primes.c */
/* Copyright 1992 by P.J. LaBrocca */

#include &lt;stdlib.h&gt;
#include "mixed.h"

#define NUM 16000     /* highest number to check for being prime */

Integer Primes[ 2000 ];

void init_primes( void )
{
    char *mark = malloc(NUM * sizeof(char) );
    Integer *pr = Primes; /* point to global array */
    Integer j, k;

    for(j = 0; j &lt; NUM; ++j)
       mark[j] = 1;      /* mark everything prime */
    for(j = 4; j &lt; NUM; j += 2)
       mark[j] = 0;     /* scratch off all the even numbers ... */
    *pr++ = 2;           /* ... except for 2; put it in primes array */
    for(j = 3; j &lt; NUM; j += 2)  /* check each odd number: */
       if(mark[j]) {            /* if it's marked... */
           *pr++ = j;          /* ..record it in array.. */
           for(k = j + j; k &lt; NUM; k += j)
              mark[k] = 0;     /* ..and scratch off all its multiples */
       }
    free( mark );
}
#undef NUM
/* End of File */
</pre>
</BODY>
</HTML>
