<HTML><HEAD>
<TITLE>May 1994/Code Capsules/Listing 5</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 5 <I>Implementation for <a href="list4.htm">Listing 4</a></I></A></h4>
<pre>// str.cpp

#include &lt;iostream. h&gt;
#include &lt;string.h&gt;
#include "str.h"

String::String(const char *buf)
{
    if (!buf)
        rep = new Srep("");
    else
        rep = new Srep(buf);
}

String::String(const String&amp; s)
{
    rep = s.rep;
    rep-&gt;count++;
}

String::~String()
{
    if (--rep-&gt;count &lt;= 0)
        delete rep;
}

String::Srep::Srep(const char* s)
{
    strcpy(rep = new char[strlen(s)+1], s);
    count = 1;
}

String::Srep::~Srep()
{
    delete [] rep;
}
// End of File
</pre>
</BODY>
</HTML>
