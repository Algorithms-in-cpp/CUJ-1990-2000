<HTML><HEAD>
<TITLE>September 1995/Quick MS-Windows Dialog Design/Listing 3</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 3 <I>Definition of class</I> DESCRIPT</A></h4>
<pre>//////////////////////////////////////////////////////
// DESCRIPT, a STR-ing used as a descriptor:
// &lt;type&gt;['|'&lt;param&gt;=&lt;value&gt;]
//////////////////////////////////////////////////////
#if !defined(DESCRIPT_HPP)
#define DESCRIPT_HPP
#if !defined(RC_INVOKED) // real C++ stuff
#include "STR.HPP"
class DESCRIPT : public STR {
public:
   DESCRIPT(const char szS[] = 0);
   virtual ~DESCRIPT();

   const char* type(STR&amp; Buf) const;
   const char* value(const char szParam[], STR&amp; Buf)
                          const;
   int value(const char szParam[], int nDefVal = 0)
                          const;

   void setType(const char szType[]);
   void addParam(const char szParam[],
                const char szValue[]);
   void addParam(const char szParam[], int nValue);

private:
   short isSep(int c, int k) const;
   const char* retVal(STR&amp; Buf) const;
   enum { SLASH = '|', EQUAL = '=', LIT = '\\'};
};

class MULTIPARAM {
Public:
   MULTIPARAM(const DESCRIPT* Desc,
             const char szMP[]);
   ~MULTIPARAM() {};
   int no() const { return_n; }
   const char* value(int index, STR&amp; Buf);
   int value(int index, int nDefVal = 0);

private:
   const DESCRIPT* const_desc;
   const STR_mp;
   int_n;
   STR_full;
   const char *_makeParam(int index);
   };
#endif
#endif
</pre>
</BODY>
</HTML>
