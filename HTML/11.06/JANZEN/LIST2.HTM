<HTML><HEAD>
<TITLE>June 1993/Recovering Corrupted Waveforms/Listing 2</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 2 <I>The expression for deconvolution in the discrete domain</I></A></h4>
<pre>void deconvolve_wave(const long int sequence_len,
                  const double *convolving_func,
                  const double *convolved,
                  double *h)
{
   auto double temp_wave_point_value,
             temp_wave1_recip
                          = 1.0 / convolving_func[1];
   auto long int   k,
                i;

   for (k = 0; k &lt; sequence_len; k++)
   {
       temp_wave_point_value = 0.0;
       for (   i = 1;
              i &lt; k;
              i++)
       {
           temp_wave_point_value += h[i]
              * (convolving_func[k + 1 - i]);
       }
       h[k] = temp_wave1_recip
          * (convolved[k] - temp_wave_point_value);
   }
   return;
}

/* End of File */
</pre>
</BODY>
</HTML>
