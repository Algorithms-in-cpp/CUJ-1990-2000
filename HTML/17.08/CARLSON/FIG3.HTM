<HTML><HEAD>
<TITLE>August 1999/An Automated Process Shutdown DLL/Figure 3</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 3: Sample MFC CApp-based Implementation</A></h4>
<pre>
CShutdownProcessTest1App::CShutdownProcessTest1App() 
{
    hInstance = LoadLibrary("SHUTDOWN.DLL"); 
    LoadDLL = 
        reinterpret_cast&lt;LOADDLL&gt;
            (GetProcAddress(hInstance, "LoadDLL") );
    ShutdownProcess = 
        reinterpret_cast&lt;SHUTDOWNPROCESS&gt;
            (GetProcAddress(hInstance, "ShutdownProcess") );
    LoadDLL();
}
     
     
CShutdownProcessTest1App::~CShutdownProcessTest1App() 
{
    FreeLibrary(hInstance);
}



</pre>
</BODY>
</HTML>
