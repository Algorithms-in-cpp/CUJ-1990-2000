<HTML><HEAD>
<TITLE>August 1999/A Semaphore With Priorities For Win32/Figure 1</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 1: Pseudo-Code for CPrioritySemaphore::Wait</A></h4>
<pre>
CPrioritySemaphore::Wait(LONG lPriority)
{

   enter the critical section
   if( lPriority is not the lowest priority level )
   {
      increment the thread count for level lPriority
      reset the event associated with level lPriority
   }
   leave the critical section
  
   wait for the semaphore and all events associated with 
   levels X, where X &gt; lPriority, to be simultaneously signalled
  
   enter the critical section
   if( lPriority is not the lowest priority level )
   {
      decrement the thread count for lPriority
      if( the thread count for level lPriority equals 0 )
      {
         set the event associated with level lPriority
      }
   }
   leave the critical section

}


</pre>
</BODY>
</HTML>
