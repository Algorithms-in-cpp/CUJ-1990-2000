<HTML><HEAD>
<TITLE>April 1994/Stepping Up To C++/Listing 1</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 1 The Main module for the cross-reference program</A></h4>
<pre>//
// xr.cpp - a cross-reference generator
//
#include &lt;assert.h&gt;
#include &lt;ctype.h&gt;
#include &lt;stdio.h&gt;

#include "xrt.h"

int getword(char *word, size_t lim)
   {
   int c;
   char *w = word;

   assert(lim &gt; 2);
   while (isspace(c = fgetc(stdin)) &amp;&amp; c != '\n')
      ;
   if (c != EOF)
      *w++ = c;
   if (!isalpha(c))
      {
      *w = '\0';
      return c;
      }
   for ( ; lim-- &gt; 0; ++w)
      if (!isalnum(*w = fgetc(stdin)))
         {
         ungetc(*w, stdin);
         break;
         }
   *w = '\0';
   return *word;
   }

#define MAXWORD 100

int main()
   {
   char word[MAXWORD];
   unsigned lineno = 1;
   xrt x;

   while (getword(word, MAXWORD) != EOF)
      if (isalpha(word[0]))
         x.add(word, lineno);
      else if (word[0] == '\n')
         ++lineno;
   x.print();
   return 0;
   }

// End of File
</pre>
</BODY>
</HTML>
