<HTML><HEAD>
<TITLE>May 1995/Code Capsules/Listing 5</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 5 Implementation for<I> <a href="list4.htm">Listing 4</a></A></I></h4>
<pre>/* date2.c */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include "date2.h"

struct Date
{
   int month;
   int day;
   int year;
};

static const char *month_text[] =
   {"Bad month", "January", "February",
    "March", "April", "May", "June", "July",
    "August", "September", "October",
    "November", "December"};

Date *date_create(int m, int d, int y)
{
   Date *dp = malloc(sizeof(Date));
   if (dp == NULL)
      return NULL;

   dp-&gt;month = m;
   dp-&gt;day = d;
   dp-&gt;year = y;
   return dp;
}

char *date_format(const Date *dp, char *buf)
{
   sprintf(buf,"%s %d, %d",
          month_text [dp-&gt;month],dp-&gt;day,
          dp-&gt;year);
   return buf;
}

int date_compare(const Date *dp1,
              const Date *dp2)
{
   int result = dp1-&gt;year - dp2-&gt;year;
   if (result == 0)
      result = dp1-&gt;month - dp2-&gt;month;
   if (result == 0)
      result = dp1-&gt;day - dp2-&gt;day;
   return result;
}

void date_destroy(Date *dp)
{
   free(dp);
}
/* End of File */
</pre>
</BODY>
</HTML>
