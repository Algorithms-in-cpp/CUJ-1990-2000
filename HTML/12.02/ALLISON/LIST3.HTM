<HTML><HEAD>
<TITLE>February 1994/Code Capsules/Listing 3</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 3 <I>Encapsulates the parameter extraction logic</I></A></h4>
<pre>/* vargs2.c */
#include &lt;stdio.h&gt;

#define first_arg(x,p) \
  p = (char *) &amp;x + sizeof(x)
#define next_arg(p,T,x) \
  x = *(T*)p; p += sizeof(T)

void int_string_pairs(size_t npairs,...)
{
   int n;
   char *s, *p;
   
   first_arg(npairs,p);
   while (npairs--)
   {
      
      next_arg(p,int,n);
      next_arg(p,char *,s);
      printf("%d, %s\n",n,s);
   }
}

main()
{
   int_string_pairs(3,1,"one",2,"two",3,"three");
   return 0;
}

/* End of File */
</pre>
</BODY>
</HTML>
