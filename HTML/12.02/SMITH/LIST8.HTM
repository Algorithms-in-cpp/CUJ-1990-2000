<HTML><HEAD>
<TITLE>February 1994/Coding with Printable Characters/Listing 8</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 8 <I>Header for 16-bit CRC calculation</I></A></h4>
<pre>/* CRC16.H
 *
 * Use updcrc() for a block of data,
 * UPDATE_CRC1() for a single byte.
 *
 * Adapted from CRC-16F.C, a public domain routine
 * in Bob Stout's Snippets file collection.
 * Adaptations donated to public domain.
*/

#define CRCW 16             /* # bits in CRC */
#define CRCLBY (CRCW/8)     /* CRC byte length */
#define CRCMASK ((1U&lt;&lt;CRCW)-1) /* mask for full CRC */

extern unsigned short crctab[1 &lt;&lt; 8];

void initcrctab(void);  /* Initialize CRC table */
unsigned short updcrc(unsigned short icrc,
   const unsigned char *icp, unsigned int icnt);

#define UPDATE_CRC1(c,crc) (((crc)&lt;&lt;8) ^ \
       crctab[(((crc)&gt;&gt;(CRCW-8)) ^ (c)) &amp; 0xff])

/* End of File */
</pre>
</BODY>
</HTML>
