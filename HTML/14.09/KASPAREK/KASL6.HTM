



<HTML><HEAD>

<TITLE>September 2000/Processing Variant Records with STL/Listing 6</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">
<h4>Listing 6:	Test driver program and output</h4>
<blockquote>
<pre>

#include &lt;fstream.h&gt;
#include &lt;memory.h&gt;
#include "Globals.h"
#include "file.h"

void main()
{
    File file;
    file.Init("data.dat");
    BOOL bStatus;
    fstream out;
    out.open("out.txt", ios::out);
    cout = out;

    sVariantRecord rec;
    memset(&amp;rec, 0, sizeof(sVariantRecord));

    bStatus = file.GetRecord(rec);
    while (bStatus != NULL) {
        cout &lt;&lt; "Name: " &lt;&lt; rec.Name &lt;&lt; '\n';
        cout &lt;&lt; "Format: " &lt;&lt; rec.Format &lt;&lt; '\n';
        switch (rec.Format) {
        case FORMAT1:
            cout &lt;&lt; "Amount: " &lt;&lt; rec.sFormat1.Amount &lt;&lt; '\n';
            cout &lt;&lt; "Date: " &lt;&lt; rec.sFormat1.Date &lt;&lt; '\n';
            break;
        case FORMAT2:
            cout &lt;&lt; "Date: " &lt;&lt; rec.sFormat2.Date &lt;&lt; '\n';
            cout &lt;&lt; "Desc: " &lt;&lt; rec.sFormat2.Desc &lt;&lt; '\n';
            break;
        case FORMAT3:
            cout &lt;&lt; "Amount: " &lt;&lt; rec.sFormat3.Amount &lt;&lt; '\n';
            cout &lt;&lt; "Date: " &lt;&lt; rec.sFormat3.Date &lt;&lt; '\n';
            cout &lt;&lt; "Desc: " &lt;&lt; rec.sFormat3.Desc &lt;&lt; '\n';
            break;
        default:
            cout &lt;&lt; "ho hum" &lt;&lt; '\n';
            break;
        }
        cout &lt;&lt; '\n';
        memset(&amp;rec, 0, sizeof(sVariantRecord));
        bStatus = file.GetRecord(rec);
    }
    out.close();
}

//output:

Name: C/C++
Format: 1
Amount: 100.99
Date: 04/03/96

Name: Users
Format: 2
Date: 05/17/96
Desc: La de da!

Name: Journal
Format: 3
Amount: 800.25
Date: 12/25/96
Desc: Hum de dum!

//End of File
</pre></blockquote>
</body></html>
