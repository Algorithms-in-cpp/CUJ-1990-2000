<HTML><HEAD>
<TITLE>May 1992/A Simple Formula for Digital Filtering/Listing 1</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 1 Impulse Response Function</a></h4>
<pre>#include &lt;stdio.h&gt;

void impulse_response(FILE *out, int N,
double a, double b, double c)
{
   double
      y = c,   /* The most recent system output value */
      y1 = 0;  /* The previous output */
   
   /* Time t = 0, before the impulse. */
   fprintf(out, "%lg\n", y1);
   
   /* Time t = 1, the instant of the impulse. */
   fprintf(out, "%1g\n", y);
   
   N -= 2;  /* Two points already written */
   
   /* All later times, t &gt; 1 */
   while(N-- &gt;= 0)
   {
      double t = y;
      y = a*y + b*y1;
      y1 = t;
      fprintf(out, "%lg\n", y);
   }
}
</pre>
</BODY>
</HTML>
