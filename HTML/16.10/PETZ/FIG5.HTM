<HTML><HEAD>
<TITLE>October 1998/A C++ Telephony Interface/Figure 5</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 5: Modem class declaration</A></h4>
<pre>
class AFX_EXT_CLASS CRemoteConnect : public CLocalConnect
{
// public interface
public:
    enum MODEM_CONNECTTYPE {MAKECALL,ANSWERCALL,DEFERCALL};
    CRemoteConnect(MODEM_CONNECTTYPE,
        BOOL spawnThreadOnConnect=TRUE, BOOL enableEcho=FALSE);
    virtual ~CRemoteConnect();
    BOOL isModemConnected() { return m_ModemConnected; };
    HANDLE&amp; GetConnectEventHandle() { return m_ConnectEvent; };
    HANDLE&amp; GetDisconnectEventHandle()
    { return m_DisconnectEventHandle; };

// server prepares for next call
    BOOL ReAnswerModem();

// some redefined members
public:
    virtual BOOL PortInitOk() { return m_ModemConnected; }

// TAPI private helper functions &lt;not shown for brevity&gt;
};
</pre>
</BODY>
</HTML>
