<HTML><HEAD>
<TITLE>August 2000/A Simple Persistence Framework/Listing 5</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 5: The objAvl class</A></h4>
<pre>
#ifndef OBJAVL_H
#define OBJAVL_H

#include "POBObj.h"

#include &lt;deque&gt;

class objAvl : public POBObj {
    friend ostream&amp; operator&lt;&lt;(ostream&amp;, objAvl&amp;);

public:
    typedef pair&lt;size_t, streampos&gt; SIZE_POS;

    objAvl();
    ~objAvl();
    objAvl&amp; operator=(const objAvl&amp;);

    static POBObj* create() { return (POBObj*)(new objAvl); }
    operator const string&amp; ();
    void operator=(const string&amp;);

    bool   isEmpty();
    bool   getAvl(size_t, streampos&amp;);
    void   addAvl(size_t, streampos);
    void   removepad();
    bool   isEmptySlot(streampos, size_t&amp;);
    size_t spaceRecollection();
    size_t deqsize();
    
private:
    void getpos(int, int size, streampos&amp;);
    bool deque_best_bsearch(size_t, size_t&amp;);
    void swap(int, int);
    void sort_by_pos(int, int);
    void sort_by_size(int, int);

private:
    const size_t _max;
    size_t _acc_size;
    int       _pad_size;
    deque&lt;SIZE_POS&gt; _avl;
};

#endif 
</pre></body></html>
