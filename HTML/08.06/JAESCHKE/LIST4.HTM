<HTML><HEAD><TITLE>June 1990/Dr. C's Pointers/Listing 4</TITLE></HEAD><BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">
<h4><A name="0159_00C9"><A name="0159_00C9">Listing 4<A name="0159_00C9"></FONT></h4><P>
<pre>#include &lt;stdio.h&gt;</FONT>
#include &lt;stdlib.h&gt;</FONT>

#define SET 1</FONT>
#define CLEAR 0</FONT>
#define NUMELEM(a) (sizeof(a)/sizeof(a[O]))</FONT>

void eh(void);</FONT>
void cf0(void);    /* cleanup functions */</FONT>
void cf1(void);</FONT>
void cf2(void);</FONT>
void cf3(void);</FONT>

struct status_flags {</FONT>
   unsigned char flag;</FONT>
   void (*pfun)(void);</FONT>
} handler[] = {</FONT>
   {CLEAR, cf0},</FONT>
   {CLEAR, cf1},</FONT>
   {CLEAR, cf2},</FONT>
   {CLEAR, Cf3}</FONT>
};</FONT>

main()</FONT>
{</FONT>
   atexit(eh);</FONT>

   handler[1].flag = SET;</FONT>
   handler[3].flag = SET;</FONT>
}</FONT>

void eh(void)</FONT>
{</FONT>
   int i;</FONT>

   for (i = 0; i &lt; NUMELEM(handler); i++) {</FONT>
      if (handler[i].flag == SET)
         (*handler[i].pfun) ();
   }</FONT>
}</FONT>

void cf0(void)</FONT>
{</FONT>
   printf("Inside cf0\n");</FONT>
}</FONT>

...</FONT>

void cf3(void)</FONT>
{</FONT>
   printf("Inside cf3\n");</FONT>
}</FONT>

Inside cf1</FONT>
Inside cf3</FONT>
</pre>
</BODY>
</HTML>
