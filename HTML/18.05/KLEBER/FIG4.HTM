<HTML><HEAD>
<TITLE>May 2000/Thread-Safe Access to Collections/Figure 4</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 4: Using the lock template and collection class</A></h4>
<pre>
int ThreadSafeIterate()
{
    MyCollection data;
    CollectionAutoLock lock(data);
    const int iCount = data.Count();
    for ( int i = 0; i &lt; iCount; ++i )
    {
        MyItem&amp; item = data.At(i);
        // do something
    }
}
</pre></body></html>
