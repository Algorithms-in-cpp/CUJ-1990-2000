<HTML><HEAD>
<TITLE>September 1994/Stepping Up To C++/Listing 5</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 5 <I>A test program for a queue of </I>str<I> implemented using </I>genq</A></h4>
<pre>//
// strtst4.cpp - test genq4 using str elements
//

#include &lt;iostream.h&gt;

#include "showheap.h"
#include "strq4.h"

void print_str(void *e, void *args)
       {
       *(ostream *)args &lt;&lt; ' ' &lt;&lt; *(str *)e;
       }

inline ostream &amp;operator&lt;&lt;(ostream &amp;os, strq &amp;q)
       {
       q.apply(print_str, &amp;os);
       return os;
       }

#define DIM(a) (sizeof(a)/sizeof(a[0]))

void test()
       {
       char c;
       size_t qn;
       str qe;
       strq q[4];
       while (cin &gt;&gt; c)
              {
              showheap();
              if (c == 'q')
                     break;
              if (c == 'a')
                     {
                     cin &gt;&gt; qn &gt;&gt; qe;
                     if (qn &gt;= DIM(q))
                            cout &lt;&lt; "no such queue\n";
                     else
                            q[qn].append(qe);
                     }
              else if (c == 'c')
                     {
                     cin &gt;&gt; qn;
                     if (qn &gt;= DIM(q))
                            cout &lt;&lt; "no such queue\n";
                     else
                            q[qn].clear();
                     }
              else if (c == 'r')
                    {
                     cin &gt;&gt; qn;
                     if (qn &gt;= DIM(q))
                            cout &lt;&lt; "no such queue\n";
                     else if (q[qn].remove(qe))
                            cout &lt;&lt; "removed"
                                &lt;&lt; qe &lt;&lt; '\n';
                     else
                            cout &lt;&lt; "q[" &lt;&lt; qn
                                &lt;&lt; "] is empty\n";
                     }
              else
                     continue;
              for (size_t i = 0; i &lt; DIM(q); ++i)
                     cout &lt;&lt; i &lt;&lt; ':' &lt;&lt; q[i] &lt;&lt; '\n';
              }
       }

int main()
       {
       showheap();
       test();
       showheap();
       return 0;
       }

// End of File
</pre>
</BODY>
</HTML>
