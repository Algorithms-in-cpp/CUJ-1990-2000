<HTML><HEAD>
<TITLE>September 1994/Code Capsule/Listing 20</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 20 <I>Integrates the implementation of the</I> bitref<I> class with the </I>bitstring<I> class</A></I></h4>
<pre>// bitstr.cpp

// The following are added to the implementation of bitstring.
// (See "Bit Manipulation in C++, Part 1", CUJ, Dec. 1993)

bitstring::bitref bitstring::operator[](size_t pos)
{
   return bitref(*this,pos);
}

bitstring::bitref::bitref(bitstring&amp; bs_, size_t bit_)
  : bs(bs_)
{
   bit = bit_;
}
int bitstring::bitref::operator=(int val)
{
   if (val)
      bs.set(bit);
   else
      bs.reset(bit);
   return val;
}

bitstring::bitref::operator int()
{
   return bs.test(bit);
}
// End of File
</pre>
</BODY>
</HTML>
