



<HTML><HEAD>

<TITLE>July 1997/An Automated Testing Tool for Win16/Listing 1</TITLE></HEAD>
<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">
<h4>Listing 1:	Header file for automated test library</h4>

<pre>
//******************************************************************
// Application Module : TRACKER.H
//
// Description :        Header file for our system message tracker.
//
// Creator :            Paul D. Carlson
// Date :               2/05/97
//******************************************************************

#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;sys\timeb.h&gt;

// Local Defines.
#define LOGFILENAME_SIZE    128

// Function Prototypes.
LRESULT CALLBACK _export
JournalRecordProc(int code, WPARAM wParam, LPARAM lParam);

LRESULT CALLBACK _export
JournalPlaybackProc(int code, WPARAM wParam, LPARAM lParam);

int checkFileHandle(void);
void closeLogFile(void);
long elaspedTime(struct timeb *, struct timeb *);
int initLogFile(void);
int logger(LPEVENTMSG, long);
int openLogFile(int access_mode);
void reader(EVENTMSG *, long *);
int readLogFile(EVENTMSG *, long *);
int FAR PASCAL _export startPlayback(char far *, int);
int FAR PASCAL _export startRecording(char far *);
void stopPlayback(void);
void FAR PASCAL _export stopRecording(void);
int writeLogFile(LPEVENTMSG, long);

// Module variable declarations

HOOKPROC        recordProc = 0;
HHOOK           hhRecordProc = 0;
HOOKPROC        playbackProc = 0;
HHOOK           hhPlaybackProc = 0;
HINSTANCE       ghInstance= 0;

HFILE           logFileHandle = 0;
char            logFileName[129];
int             iterations = 0;

struct timeb    lastTimeMark;
long            readOffSet = 0;
// End of File
</pre>
</body></html>
