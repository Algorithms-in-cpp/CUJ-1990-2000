<HTML><HEAD>
<TITLE>July 1993/A Windows and MS-DOS C++ Output Stream for a Secondary Monitor/Listing 3</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 3 libmain.cpp &#151; <I>defines the DLL startup and shutdown procedures that Windows requires</I></A></h4>
<pre>// LIBMAIN.CPP
// Define the DLL startup and shutdown procedures that
// Windows requires.

#include &lt;windows.h&gt;
extern "C" int FAR PASCAL _export
LIBMAIN( HANDLE, WORD, WORD wHeapSize, LPSTR )
{
        // Initializes the local heap (if there is one)
        // with a call to LocalInit which locks the data
        // segment.
    if ( wHeapSize != 0 )
        UnlockData( 0 );
        return 1;
}

int FAR PASCAL _export
WEP( int )
{
    return 1;
}
/* End of File */
</pre>
</BODY>
</HTML>
