<HTML><HEAD>
<TITLE>March 1994/Weight Reduction Techniques in C++/Figure 1</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 1<I> Good objects must do their own memory management</A></I></h4>
<pre>class BadString {
public:
// Using the pointer directly:
  BadString(char *s) { ptr = s; }
// Where did pointer come from:
  ~BadString() { delete[] ptr; }
private:
  char *ptr;
};

char *strdup(const char *str)
{
  return strcpy(new
    char[strlen(str)+1],str);
}

class GoodString {
public:
// Don't use the pointer, copy it:
  GoodString(const char *s)
    { ptr= strdup(s); }
// Now you can safely delete it:
  ~GoodString()
    { delete[] ptr; }
private:
  char *ptr;
};

// End of File</pre>
</BODY>
</HTML>
